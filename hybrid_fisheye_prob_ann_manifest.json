{
  "run_name": "hybrid_fisheye_prob_ann",
  "params": {
    "date_fmt": "%d-%b-%y",
    "context_len": 128,
    "features_per_t": 4,
    "embed_dim": 256,
    "attn_dim": 128,
    "attn_heads": 4,
    "dropout": 0.1,
    "l2_weight": 1e-06,
    "seed": 77,
    "epochs_p1": 16,
    "epochs_p2": 4,
    "batch": 64,
    "lr_pretrain": 0.0001,
    "lr_p2": 1e-05
  },
  "files": {
    "train_path": "C:\\Users\\loweb\\AI_Financial_Sims\\HO\\HO 1st time 5080\\hoxnc_training.csv",
    "val_path": "C:\\Users\\loweb\\AI_Financial_Sims\\HO\\HO 1st time 5080\\hoxnc_validation.csv",
    "test_path": "C:\\Users\\loweb\\AI_Financial_Sims\\HO\\HO 1st time 5080\\hoxnc_testing.csv",
    "train_sha256": "04cc097bd744e1262ad885596c79c34d167f0a8e04b4d2dda919edb149709186",
    "val_sha256": "39389b5d46fde2f372171501b61d3300f0c9913cfe0a2c783b792566bb1b07b9",
    "test_sha256": "d7e75485054836422f7f4311def959ccd01bcdaba614326f16e3ac2be89c216a",
    "df_train_sha256": "421168298c2ddbf1a65516dc28b4b9308d13560ed4141e0225183af767ef0d02",
    "df_val_sha256": "3d8bf38248e7d6d1073ccd1e1f14aca377ad24574c17aaf29e5adcfd306731a1",
    "df_test_sha256": "649a8c1e75f508bd1d55333cd1d56c572e6074a62be82da47b9e2ad06fa97412"
  },
  "metrics": {
    "final_train_loss": 5.752383708953857,
    "final_val_loss": 15.339804649353027,
    "test_nll": 7.462459679021522,
    "persistence_comparison": {
      "persistence_mae": 2.1062510013580322,
      "model_mae": 2.1097664833068848,
      "absolute_improvement": -0.003515481948852539,
      "relative_improvement": -0.0016690707549033268,
      "paired_ttest_t": -0.6820588484366961,
      "paired_ttest_p": 0.4953297378728342
    }
  },
  "debug_checks": {
    "date_checks_head": [
      {
        "split": "train",
        "dates_head": [
          "1982-01-06 00:00:00",
          "1982-01-07 00:00:00",
          "1982-01-08 00:00:00",
          "1982-01-11 00:00:00",
          "1982-01-12 00:00:00",
          "1982-01-13 00:00:00",
          "1982-01-14 00:00:00",
          "1982-01-15 00:00:00",
          "1982-01-18 00:00:00",
          "1982-01-19 00:00:00",
          "1982-01-20 00:00:00",
          "1982-01-21 00:00:00"
        ]
      },
      {
        "split": "val",
        "dates_head": [
          "2000-01-04 00:00:00",
          "2000-01-05 00:00:00",
          "2000-01-06 00:00:00",
          "2000-01-07 00:00:00",
          "2000-01-10 00:00:00",
          "2000-01-11 00:00:00",
          "2000-01-12 00:00:00",
          "2000-01-13 00:00:00",
          "2000-01-14 00:00:00",
          "2000-01-18 00:00:00",
          "2000-01-19 00:00:00",
          "2000-01-20 00:00:00"
        ]
      },
      {
        "split": "test",
        "dates_head": [
          "2001-01-02 00:00:00",
          "2001-01-03 00:00:00",
          "2001-01-04 00:00:00",
          "2001-01-05 00:00:00",
          "2001-01-08 00:00:00",
          "2001-01-09 00:00:00",
          "2001-01-10 00:00:00",
          "2001-01-11 00:00:00",
          "2001-01-12 00:00:00",
          "2001-01-16 00:00:00",
          "2001-01-17 00:00:00",
          "2001-01-18 00:00:00"
        ]
      }
    ],
    "diagnostic_head": [
      {
        "window_end_idx": 127,
        "window_end_date": "2001-07-05 00:00:00",
        "target_idx": 128,
        "target_date": "2001-07-06 00:00:00",
        "window_last_close": 72.38999938964844,
        "target_close": 73.77999877929688,
        "persistence_close": 72.38999938964844,
        "mu_residual_std": 0.04628092050552368,
        "mu_residual_denorm": 0.060493748635053635,
        "mu_abs": 72.45049285888672,
        "log_var_raw": -2.367396354675293,
        "log_var_report": -2.367396354675293
      },
      {
        "window_end_idx": 128,
        "window_end_date": "2001-07-06 00:00:00",
        "target_idx": 129,
        "target_date": "2001-07-09 00:00:00",
        "window_last_close": 73.77999877929688,
        "target_close": 72.79000091552734,
        "persistence_close": 73.77999877929688,
        "mu_residual_std": 0.04601558670401573,
        "mu_residual_denorm": 0.06012220308184624,
        "mu_abs": 73.84011840820312,
        "log_var_raw": -2.3709120750427246,
        "log_var_report": -2.3709120750427246
      },
      {
        "window_end_idx": 129,
        "window_end_date": "2001-07-09 00:00:00",
        "target_idx": 130,
        "target_date": "2001-07-10 00:00:00",
        "window_last_close": 72.79000091552734,
        "target_close": 72.33000183105469,
        "persistence_close": 72.79000091552734,
        "mu_residual_std": 0.04578711465001106,
        "mu_residual_denorm": 0.059802282601594925,
        "mu_abs": 72.84980010986328,
        "log_var_raw": -2.3740015029907227,
        "log_var_report": -2.3740015029907227
      },
      {
        "window_end_idx": 130,
        "window_end_date": "2001-07-10 00:00:00",
        "target_idx": 131,
        "target_date": "2001-07-11 00:00:00",
        "window_last_close": 72.33000183105469,
        "target_close": 70.58999633789062,
        "persistence_close": 72.33000183105469,
        "mu_residual_std": 0.045615557581186295,
        "mu_residual_denorm": 0.05956205353140831,
        "mu_abs": 72.38956451416016,
        "log_var_raw": -2.377159833908081,
        "log_var_report": -2.377159833908081
      },
      {
        "window_end_idx": 131,
        "window_end_date": "2001-07-11 00:00:00",
        "target_idx": 132,
        "target_date": "2001-07-12 00:00:00",
        "window_last_close": 70.58999633789062,
        "target_close": 70.66999816894531,
        "persistence_close": 70.58999633789062,
        "mu_residual_std": 0.045374009758234024,
        "mu_residual_denorm": 0.05922381207346916,
        "mu_abs": 70.64922332763672,
        "log_var_raw": -2.3809738159179688,
        "log_var_report": -2.3809738159179688
      },
      {
        "window_end_idx": 132,
        "window_end_date": "2001-07-12 00:00:00",
        "target_idx": 133,
        "target_date": "2001-07-13 00:00:00",
        "window_last_close": 70.66999816894531,
        "target_close": 68.73999786376953,
        "persistence_close": 70.66999816894531,
        "mu_residual_std": 0.04505854845046997,
        "mu_residual_denorm": 0.05878208205103874,
        "mu_abs": 70.7287826538086,
        "log_var_raw": -2.3846492767333984,
        "log_var_report": -2.3846492767333984
      },
      {
        "window_end_idx": 133,
        "window_end_date": "2001-07-13 00:00:00",
        "target_idx": 134,
        "target_date": "2001-07-16 00:00:00",
        "window_last_close": 68.73999786376953,
        "target_close": 68.80999755859375,
        "persistence_close": 68.73999786376953,
        "mu_residual_std": 0.044859547168016434,
        "mu_residual_denorm": 0.058503422886133194,
        "mu_abs": 68.79850006103516,
        "log_var_raw": -2.387708902359009,
        "log_var_report": -2.387708902359009
      },
      {
        "window_end_idx": 134,
        "window_end_date": "2001-07-16 00:00:00",
        "target_idx": 135,
        "target_date": "2001-07-17 00:00:00",
        "window_last_close": 68.80999755859375,
        "target_close": 68.69000244140625,
        "persistence_close": 68.80999755859375,
        "mu_residual_std": 0.044716570526361465,
        "mu_residual_denorm": 0.05830321088433266,
        "mu_abs": 68.86830139160156,
        "log_var_raw": -2.3911266326904297,
        "log_var_report": -2.3911266326904297
      },
      {
        "window_end_idx": 135,
        "window_end_date": "2001-07-17 00:00:00",
        "target_idx": 136,
        "target_date": "2001-07-18 00:00:00",
        "window_last_close": 68.69000244140625,
        "target_close": 67.25,
        "persistence_close": 68.69000244140625,
        "mu_residual_std": 0.044462546706199646,
        "mu_residual_denorm": 0.05794750899076462,
        "mu_abs": 68.7479476928711,
        "log_var_raw": -2.394883871078491,
        "log_var_report": -2.394883871078491
      },
      {
        "window_end_idx": 136,
        "window_end_date": "2001-07-18 00:00:00",
        "target_idx": 137,
        "target_date": "2001-07-19 00:00:00",
        "window_last_close": 67.25,
        "target_close": 66.80000305175781,
        "persistence_close": 67.25,
        "mu_residual_std": 0.044214095920324326,
        "mu_residual_denorm": 0.05759960785508156,
        "mu_abs": 67.30760192871094,
        "log_var_raw": -2.3989596366882324,
        "log_var_report": -2.3989596366882324
      },
      {
        "window_end_idx": 137,
        "window_end_date": "2001-07-19 00:00:00",
        "target_idx": 138,
        "target_date": "2001-07-20 00:00:00",
        "window_last_close": 66.80000305175781,
        "target_close": 68.11000061035156,
        "persistence_close": 66.80000305175781,
        "mu_residual_std": 0.04393153265118599,
        "mu_residual_denorm": 0.05720393732190132,
        "mu_abs": 66.85720825195312,
        "log_var_raw": -2.403156042098999,
        "log_var_report": -2.403156042098999
      },
      {
        "window_end_idx": 138,
        "window_end_date": "2001-07-20 00:00:00",
        "target_idx": 139,
        "target_date": "2001-07-23 00:00:00",
        "window_last_close": 68.11000061035156,
        "target_close": 68.38999938964844,
        "persistence_close": 68.11000061035156,
        "mu_residual_std": 0.04362669214606285,
        "mu_residual_denorm": 0.05677707493305206,
        "mu_abs": 68.16677856445312,
        "log_var_raw": -2.4066550731658936,
        "log_var_report": -2.4066550731658936
      },
      {
        "window_end_idx": 139,
        "window_end_date": "2001-07-23 00:00:00",
        "target_idx": 140,
        "target_date": "2001-07-24 00:00:00",
        "window_last_close": 68.38999938964844,
        "target_close": 68.7699966430664,
        "persistence_close": 68.38999938964844,
        "mu_residual_std": 0.04342535138130188,
        "mu_residual_denorm": 0.05649514123797417,
        "mu_abs": 68.44649505615234,
        "log_var_raw": -2.4101290702819824,
        "log_var_report": -2.4101290702819824
      },
      {
        "window_end_idx": 140,
        "window_end_date": "2001-07-24 00:00:00",
        "target_idx": 141,
        "target_date": "2001-07-25 00:00:00",
        "window_last_close": 68.7699966430664,
        "target_close": 70.87000274658203,
        "persistence_close": 68.7699966430664,
        "mu_residual_std": 0.04317232966423035,
        "mu_residual_denorm": 0.05614083632826805,
        "mu_abs": 68.82613372802734,
        "log_var_raw": -2.4143428802490234,
        "log_var_report": -2.4143428802490234
      },
      {
        "window_end_idx": 141,
        "window_end_date": "2001-07-25 00:00:00",
        "target_idx": 142,
        "target_date": "2001-07-26 00:00:00",
        "window_last_close": 70.87000274658203,
        "target_close": 71.88999938964844,
        "persistence_close": 70.87000274658203,
        "mu_residual_std": 0.042889561504125595,
        "mu_residual_denorm": 0.05574488267302513,
        "mu_abs": 70.92575073242188,
        "log_var_raw": -2.41872501373291,
        "log_var_report": -2.41872501373291
      },
      {
        "window_end_idx": 142,
        "window_end_date": "2001-07-26 00:00:00",
        "target_idx": 143,
        "target_date": "2001-07-27 00:00:00",
        "window_last_close": 71.88999938964844,
        "target_close": 71.30999755859375,
        "persistence_close": 71.88999938964844,
        "mu_residual_std": 0.04257383570075035,
        "mu_residual_denorm": 0.05530277639627457,
        "mu_abs": 71.94530487060547,
        "log_var_raw": -2.4226274490356445,
        "log_var_report": -2.4226274490356445
      }
    ],
    "train_mean": 0.0,
    "feat_mean": [
      58.767486572265625,
      59.409095764160156,
      58.17106628417969,
      58.78133010864258
    ],
    "feat_std": [
      15.130304336547852,
      15.207365036010742,
      15.028033256530762,
      15.128684043884277
    ],
    "y_mean": -0.0043126982636749744,
    "y_std": 1.4002842913137208
  },
  "provenance": {
    "timestamp": "2025-10-27 10:30:40",
    "script": "hybrid_fisheye_prob_ann.py",
    "python_version": "3.13.9",
    "numpy": "2.3.4",
    "pandas": "2.3.3",
    "tensorflow": "2.20.0"
  }
}